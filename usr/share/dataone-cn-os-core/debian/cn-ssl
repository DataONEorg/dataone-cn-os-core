<IfModule mod_ssl.c>
<VirtualHost *:443>
	DocumentRoot /var/www
	ServerName SERVER_NAME
	DirectoryIndex listObjects.xml

	<Directory /var/www/>
		Options Indexes FollowSymLinks MultiViews
		AllowOverride None
		Order allow,deny
		allow from all
	</Directory>
	
	RewriteEngine On
	SSLProxyEngine On
    RewriteOptions Inherit
    
   <Location /knb/metacat>
        Order allow,deny
        Allow from 127.0.0.0/8 ::1
    </Location>
    <Location /knb/servlet/metacat>
        Order allow,deny
        Allow from 127.0.0.0/8 ::1
    </Location>
    <Location /knb/d1/mn>
        Order allow,deny
        Allow from 127.0.0.0/8 ::1
    </Location>


	Include /etc/apache2/jk_mount	
	AllowEncodedSlashes On
	AcceptPathInfo On
	<Location /knb/servlet/replication>
	  SSLVerifyClient require
	  SSLVerifyDepth  10
	</Location>

	#   SSL Engine Switch:
	#   Enable/Disable SSL for this virtual host.
	SSLEngine on
	SSLOptions +StrictRequire +StdEnvVars +ExportCertData        
	SSLVerifyClient optional
	SSLVerifyDepth 10

	SSLCertificateFile /etc/ssl/certs/_.dataone.org.crt
	SSLCertificateKeyFile /etc/ssl/private/dataone_org.key
	SSLCertificateChainFile /etc/ssl/certs/gd_intermediate_bundle.crt
	
	SSLCACertificatePath /var/local/dataone/ca

</VirtualHost>

<VirtualHost *:80>
        DocumentRoot /var/www
        ServerName SERVER_NAME

        Redirect permanent / https://SERVER_NAME/
</VirtualHost>

</IfModule>

